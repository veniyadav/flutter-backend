"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.OneSignalBaseClient = void 0;
class OneSignalBaseClient {
    constructor() {
        this.BaseUrl = 'https://onesignal.com/api/v1';
    }
    get httpClient() {
        return this._httpClient || (this._httpClient = this.createHttpClientInternal());
    }
    configureHttpClient(client) {
        client.interceptors.response.use((response) => {
            return response;
        }, (error) => {
            const { config, response } = error;
            // Too many requests
            if (!!response && response.status === 429) {
                return new Promise((resolve) => {
                    setTimeout(() => resolve(client.request(config)), 1000);
                });
            }
            else {
                return Promise.reject(error);
            }
        });
    }
    createHttpClientInternal() {
        const httpClient = this.createHttpClient();
        this.configureHttpClient(httpClient);
        return httpClient;
    }
}
exports.OneSignalBaseClient = OneSignalBaseClient;
